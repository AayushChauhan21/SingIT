</div>
</div>
</div>
<!-- END MAIN-CONTENT -->

<!-- RIGHT-SIDEBAR -->

<br>
<br>

<div class="sidebar sidebar-right sidebar-animate">
    <div class="sidebar-icon">
        <a href="#" class="text-end float-end text-dark fs-20" data-bs-toggle="sidebar-right"
            data-bs-target=".sidebar-right"><i class="fe fe-x"></i></a>
    </div>
    <div class="sidebar-body">
        <h5>Todo</h5>
        <div class="d-flex p-3">
            <label class="ckbox"><input checked type="checkbox"><span>Hangout With friends</span></label>
            <span class="ms-auto">
                <i class="fe fe-edit-2 text-primary me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Edit"></i>
                <i class="fe fe-trash-2 text-danger me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Delete"></i>
            </span>
        </div>
        <div class="d-flex p-3 border-top">
            <label class="ckbox"><input type="checkbox"><span>Prepare for presentation</span></label>
            <span class="ms-auto">
                <i class="fe fe-edit-2 text-primary me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Edit"></i>
                <i class="fe fe-trash-2 text-danger me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Delete"></i>
            </span>
        </div>
        <div class="d-flex p-3 border-top">
            <label class="ckbox"><input type="checkbox"><span>Prepare for presentation</span></label>
            <span class="ms-auto">
                <i class="fe fe-edit-2 text-primary me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Edit"></i>
                <i class="fe fe-trash-2 text-danger me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Delete"></i>
            </span>
        </div>
        <div class="d-flex p-3 border-top">
            <label class="ckbox"><input checked type="checkbox"><span>System Updated</span></label>
            <span class="ms-auto">
                <i class="fe fe-edit-2 text-primary me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Edit"></i>
                <i class="fe fe-trash-2 text-danger me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Delete"></i>
            </span>
        </div>
        <div class="d-flex p-3 border-top">
            <label class="ckbox"><input type="checkbox"><span>Do something more</span></label>
            <span class="ms-auto">
                <i class="fe fe-edit-2 text-primary me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Edit"></i>
                <i class="fe fe-trash-2 text-danger me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Delete"></i>
            </span>
        </div>
        <div class="d-flex p-3 border-top">
            <label class="ckbox"><input type="checkbox"><span>System Updated</span></label>
            <span class="ms-auto">
                <i class="fe fe-edit-2 text-primary me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Edit"></i>
                <i class="fe fe-trash-2 text-danger me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Delete"></i>
            </span>
        </div>
        <div class="d-flex p-3 border-top">
            <label class="ckbox"><input type="checkbox"><span>Find an Idea</span></label>
            <span class="ms-auto">
                <i class="fe fe-edit-2 text-primary me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Edit"></i>
                <i class="fe fe-trash-2 text-danger me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Delete"></i>
            </span>
        </div>
        <div class="d-flex p-3 border-top mb-0">
            <label class="ckbox"><input type="checkbox"><span>Project review</span></label>
            <span class="ms-auto">
                <i class="fe fe-edit-2 text-primary me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Edit"></i>
                <i class="fe fe-trash-2 text-danger me-2" data-bs-toggle="tooltip" title="" data-bs-placement="top"
                    data-bs-original-title="Delete"></i>
            </span>
        </div>
        <h5>Overview</h5>
        <div class="p-4">
            <div class="main-traffic-detail-item">
                <div>
                    <span>Founder &amp; CEO</span> <span>24</span>
                </div>
                <div class="progress">
                    <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="20"
                        class="progress-bar progress-bar-xs wd-20p" role="progressbar"></div>
                </div><!-- progress -->
            </div>
            <div class="main-traffic-detail-item">
                <div>
                    <span>UX Designer</span> <span>1</span>
                </div>
                <div class="progress">
                    <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="15"
                        class="progress-bar progress-bar-xs bg-secondary wd-15p" role="progressbar"></div>
                </div><!-- progress -->
            </div>
            <div class="main-traffic-detail-item">
                <div>
                    <span>Recruitment</span> <span>87</span>
                </div>
                <div class="progress">
                    <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="45"
                        class="progress-bar progress-bar-xs bg-success wd-45p" role="progressbar"></div>
                </div><!-- progress -->
            </div>
            <div class="main-traffic-detail-item">
                <div>
                    <span>Software Engineer</span> <span>32</span>
                </div>
                <div class="progress">
                    <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="25"
                        class="progress-bar progress-bar-xs bg-info wd-25p" role="progressbar"></div>
                </div><!-- progress -->
            </div>
            <div class="main-traffic-detail-item">
                <div>
                    <span>Project Manager</span> <span>32</span>
                </div>
                <div class="progress">
                    <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="25"
                        class="progress-bar progress-bar-xs bg-danger wd-25p" role="progressbar"></div>
                </div><!-- progress -->
            </div>
        </div>
    </div>
</div>
<!-- END RIGHT-SIDEBAR -->

<!-- FOOTER -->

<div class="main-footer text-center">
    <div class="container">
        <div class="row row-sm">
            <div class="col-md-12">
                <span>Copyright Â© 2024
                    <!-- <a href="#">Spruha</a> -->. Designed by DJSariya.
                    All rights reserved.
                </span>
            </div>
        </div>
    </div>
</div>
<!-- END FOOTER -->

</div>
<!-- END PAGE -->
<!-- SCRIPTS -->

<!-- BACK TO TOP -->
<a href="#top" id="back-to-top"><i class="fe fe-arrow-up"></i></a>

<!-- JQUERY JS -->
<script src="assets/plugins/jquery/jquery.min.js"></script>

<!-- BOOTSTRAP JS -->
<script src="assets/plugins/bootstrap/js/popper.min.js"></script>
<script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>

<!-- PERFECT SCROLLBAR JS -->
<script src="assets/plugins/perfect-scrollbar/perfect-scrollbar.min.js"></script>

<!-- SIDEMENU JS -->
<script src="assets/plugins/sidemenu/sidemenu.js" id="leftmenu"></script>

<!-- SIDEBAR JS -->
<script src="assets/plugins/sidebar/sidebar.js"></script>

<!-- SELECT2 JS -->
<script src="assets/plugins/select2/js/select2.min.js"></script>
<script src="assets/js/select2.js"></script>

<!-- INTERNAL CHART.BUNDLE JS -->
<script src="assets/plugins/chart.js/Chart.bundle.min.js"></script>

<!-- PEITY JS -->
<script src="assets/plugins/peity/jquery.peity.min.js"></script>

<!-- INTERNAL APEXCHART JS -->
<script src="assets/js/apexcharts.js"></script>

<!-- INTERNAL POLYFILLS JS -->
<script src="assets/plugins/polyfill/polyfill.min.js"></script>
<script src="assets/plugins/polyfill/classList.min.js"></script>
<script src="assets/plugins/polyfill/polyfill_mdn.js"></script>

<!-- INTERNAL JVECTORMAP JS -->
<script src="assets/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>
<script src="assets/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
<script src="assets/plugins/jvectormap/gdp-data.js"></script>

<!-- ECOMMERCE DASHBOARD JS -->
<script src="assets/js/ecommerce-dashboard.js"></script>


<!--- INTERNAL NOTIFY JS -->
<script src="assets/plugins/notify/js/notifIt.js"></script>
<script src="assets/plugins/notify/js/notifit-custom.js"></script>


<!-- STICKY JS -->
<script src="assets/js/sticky.js"></script>

<!-- COLOR THEME JS -->
<script src="assets/js/themeColors.js"></script>

<!-- CUSTOM JS -->
<script src="assets/js/custom.js"></script>

<!-- SWITCHER JS -->
<script src="assets/switcher/js/switcher.js"></script>

<!-- END SCRIPTS -->

<!-- INTERNAL SWEET-ALERT JS -->
<script src="assets/plugins/sweet-alert/sweetalert.min.js"></script>
<script src="assets/plugins/sweet-alert/jquery.sweet-alert.js"></script>



</body>

<!-- Mirrored from php.spruko.com/spruha/spruha/pages/index.php by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 13 Dec 2023 07:39:39 GMT -->

</html>

<?php

include('assets/js_sweet_alert/sweet_alert.php');

?>

<script>
    // --- Live Search with Debounce Logic ---

    const API_ENDPOINT = 'http://localhost/SIngIT/flutter_crud/search.php';
    const searchInput = document.getElementById('header-search-input');
    const resultsWrapper = document.getElementById('search-results-wrapper');
    const resultsContainer = document.getElementById('header-results-container');
    const statusMessage = document.getElementById('header-status-message');
    let debounceTimer;

    /**
     * Debounce function to delay execution until the user stops typing for 5 seconds (5000ms).
     */
    const debounce = (func, delay) => {
        return function (...args) {
            clearTimeout(debounceTimer);
            // Show dropdown and initial status message immediately upon typing
            resultsWrapper.classList.add('show');
            statusMessage.innerHTML = '<i class="uil uil-search"></i> Searching...';
            debounceTimer = setTimeout(() => {
                func.apply(this, args);
            }, delay);
        };
    };

    /**
     * Renders the search results (songs and artists) in small card/list format.
     */
    const renderResults = (data) => {
        resultsContainer.innerHTML = '';

        const songCount = data.songs ? data.songs.length : 0;
        const artistCount = data.artists ? data.artists.length : 0;
        const totalCount = songCount + artistCount;

        if (totalCount === 0) {
            resultsContainer.innerHTML = `
            <div class="p-3 text-center text-muted">
            <i class="uil uil-exclamation-circle"></i> No results found for "${searchInput.value.trim()}".
            </div>
            `;
            statusMessage.innerHTML = '<i class="uil uil-times-circle"></i> No results.';
            return;
        }

        // Render Songs
        if (songCount > 0) {
            resultsContainer.innerHTML +=
                '<h6 class=" p-2 mb-0"><i class="uil uil-music"></i> Songs (' +
                songCount +
                ')</h6>';
            data.songs.slice(0, 5).forEach(song => { // Limit to top 5 songs
                resultsContainer.innerHTML += `
                <a href="view_song_details.php?sid=${song.sid}" class="search-result-item">
                <img src="${song.image || 'favicon_1.png'}" 
                class="rounded" style="height: 50px; width: 50px; object-fit: cover;" onerror="this.onerror=null;this.src='favicon_1.png';"/>
                <div>
                <p class="mb-0 font-weight-semibold">${song.name}</p>
                <small class="text-muted"> Artist: ${song.singer_name}</small>
                </div>
                </a>
                `;
            });
        }

        // Render Artists
        if (artistCount > 0) {
            resultsContainer.innerHTML +=
                '<h6 class=" p-2 mt-2 mb-0 border-top"><i class="uil uil-user-square"></i> Artists (' +
                artistCount + ')</h6>';
            data.artists.slice(0, 5).forEach(artist => { // Limit to top 5 artists
                resultsContainer.innerHTML += `
                    <a href="view_artist_details.php?arid=${artist.arid}" class="search-result-item">
                    <img src="${artist.photo || 'favicon_1.png'}" 
                    style="height: 60px; width: 45px; object-fit: cover;" onerror="this.onerror=null;this.src='favicon_1.png';"/>
                    <div>
                    <p class="mb-0 font-weight-semibold">${artist.name}</p>
                    <small class="text-muted">${artist.song_count} songs</small>
                    </div>
                    </a>
                    `;
            });
        }

        statusMessage.innerHTML =
            `<i class="uil uil-check-circle"></i> Showing ${totalCount} results.`;

    };


    /**
     * Handles the actual search execution via AJAX. (Using jQuery $.ajax)
     */
    const executeSearch = (query) => {
        query = query.trim();

        if (query.length === 0) {
            statusMessage.innerHTML = 'Start typing to search...';
            resultsWrapper.classList.remove('show');
            resultsContainer.innerHTML = '';
            return;
        }

        statusMessage.innerHTML = '<i class="fe fe-loader me-1 fa-spin"></i> Searching...';
        resultsContainer.innerHTML = '';
        resultsWrapper.classList.add('show');


        $.ajax({
            url: API_ENDPOINT,
            type: 'GET',
            data: {
                query: query
            },
            dataType: 'json',
            success: function (data) {
                if (data) {
                    renderResults(data);
                } else {
                    renderResults({
                        songs: [],
                        artists: []
                    });
                }
            },
            error: function (xhr, status, error) {
                console.error("Search API Error:", status, error);
                statusMessage.innerHTML =
                    '<i class="fe fe-alert-triangle me-1"></i> Search Failed!';
                resultsContainer.innerHTML = `
                    <div class="p-3 text-center text-danger">
                    Error connecting to ${API_ENDPOINT}.
                    </div>
                    `;
            }
        });
    };


    $(document).ready(function () {
        // Create the debounced search function (2000ms = 2 seconds)
        const debouncedSearch = debounce(executeSearch, 2000);

        // Event listener for the input field
        $('#header-search-input').on('input', function (e) {
            const query = e.target.value.trim();
            if (query.length > 0) {
                debouncedSearch(query);
            } else {
                clearTimeout(debounceTimer);
                executeSearch(''); // Clear results and status immediately
            }
        });

        // Hide results when clicking outside
        $(document).on('click', function (e) {
            // Check if the click is outside the entire search area
            if (!$(e.target).closest('.main-header-center').length) {
                resultsWrapper.classList.remove('show');
            }
        });

        // Keep dropdown open when clicking inside it
        $(resultsWrapper).on('click', function (e) {
            e.stopPropagation();
        });
    });


    // Function to handle the keyboard shortcut
    const handleKeydown = (event) => {
        // Check if Ctrl key (Windows/Linux) or Cmd key (Mac) is pressed
        const isCtrlCmd = event.ctrlKey || event.metaKey;

        // Check if the key pressed is 'q' (case-insensitive)
        // event.key is generally better than event.keyCode for letter keys
        if (isCtrlCmd && event.key.toLowerCase() === 'q') {

            // Prevent the default browser action (which might close the tab or window)
            event.preventDefault();

            // Find the search input element and set focus
            const searchInput = document.getElementById('header-search-input');
            if (searchInput) {
                searchInput.focus();

                // Optional: Select the text inside the search bar if there is any
                searchInput.select();
            }
        }
    };

    // Add the global keyboard listener once the document is loaded
    document.addEventListener('keydown', handleKeydown);
</script>